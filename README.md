# JSON 기반 HWPX 문서 수정 시스템 2026-01-15

AI 호출 없이 JSON 파일로 HWPX 문서의 텍스트를 치환하는 시스템입니다.

## 사용법

### 1. JSON 파일 사용

```bash
python main.py --input 문서.hwpx --modify data.json
```

### 2. JSON 문자열 직접 전달

```bash
python main.py --input 문서.hwpx --data '{"신청인": "가나디", "용역내용": "나 안아"}'
```

### 3. 출력 파일 지정

```bash
python main.py --input 문서.hwpx --modify data.json --output 결과.hwpx
```

## JSON 데이터 형식

### 옵션 1: 필드명 기반 (권장)

```json
{
  "신청인": "가나디",
  "주민등록번호": "950101-1234567",
  "주소지": "서울시 강남구 테헤란로 123",
  "용역기간": "2025년 01월 01일 ~ 2025년 12월 31일",
  "용역내용": "나 안아",
  "용도": "은행 제출용"
}
```

**지원 필드:**

- `신청인`: 신청인 이름
- `주민등록번호`: 주민등록번호
- `주소지`: 주소
- `용역기간`: 용역 기간
- `용역내용`: 용역 내용
- `용도`: 증명서 용도
- `업체명`: 업체명
- `사업자등록번호`: 사업자등록번호
- `주소`: 회사 주소
- `대표자`: 대표자명

### 옵션 2: 원본-수정 쌍 방식

```json
{
  "replacements": [
    {
      "original": "이한영",
      "modified": "가나디"
    },
    {
      "original": "프리랜서",
      "modified": "나 안아"
    }
  ]
}
```

## 예시

### 간단한 치환

**data.json:**

```json
{
  "신청인": "가나디",
  "용역내용": "나 안아"
}
```

**실행:**

```bash
python main.py --input 해촉증명서_샘플.hwpx --modify data.json
```

### 전체 필드 치환

**data_full.json:**

```json
{
  "신청인": "홍길동",
  "주민등록번호": "850101-1234567",
  "주소지": "서울특별시 종로구 세종대로 209",
  "용역기간": "2025년 03월 01일 ~ 2025년 12월 31일",
  "용역내용": "웹 개발 프로젝트",
  "용도": "은행 대출 제출용"
}
```

**실행:**

```bash
python main.py --input 해촉증명서_샘플.hwpx --modify data_full.json --output 수정본.hwpx
```

## 출력 파일

실행 후 다음 파일들이 생성됩니다:

1. **수정된 HWPX 파일**: `수정원본파일명.hwpx` (또는 `--output`으로 지정한 파일명)
2. **수정 내역 TXT 파일**: `수정결과_원본파일명.txt`

## 장점

✅ **빠른 처리**: AI API 호출 없이 즉시 처리  
✅ **비용 절감**: API 할당량 걱정 없음  
✅ **예측 가능**: 정확히 지정한 대로만 치환  
✅ **오프라인 작동**: 인터넷 연결 불필요  
✅ **재사용 가능**: JSON 템플릿 저장 및 재사용

## 모듈 구조

- `main.py`: 메인 실행 파일
- `text_modifier.py`: 데이터 기반 키-값 치환 로직 (핵심)
- `data_extractor.py`: HWPX 정규표현식 기반 데이터 추출 및 구조화 도구
- `xml_converter.py`: HWPX 압축 해제 및 XML 추출
- `xml_editor.py`: XML 내부 텍스트 수정 관리
- `xml_repacker.py`: 수정된 파일들로 HWPX 재구성

## 문제 해결

### JSON 파일을 찾을 수 없습니다

- JSON 파일 경로가 올바른지 확인
- 상대 경로 또는 절대 경로 사용

### 치환이 적용되지 않습니다

- JSON 필드명이 정확한지 확인
- 문서에 해당 필드가 존재하는지 확인
- 원본-수정 쌍 방식 사용 시 `original` 값이 문서와 정확히 일치하는지 확인
